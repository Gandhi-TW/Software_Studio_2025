window.__require=function e(t,o,i){function a(r,s){if(!o[r]){if(!t[r]){var c=r.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(n)return n(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var p=o[r]={exports:{}};t[r][0].call(p.exports,function(e){return a(t[r][1][e]||e)},p,p.exports,e,t,o,i)}return o[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<i.length;r++)a(i[r]);return a}({GameMgr:[function(e,t,o){"use strict";cc._RF.push(t,"9eafa6oJfhL2YaT2IrMk8jP","GameMgr"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Player"),a=cc._decorator,n=a.ccclass,r=a.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.background=null,t.wall=null,t.upperBound=null,t.lowerBound=null,t.player=null,t.platforms=null,t.platformPrefabs=[],t.startIcon=null,t.pauseIcon=null,t.scoreNode=null,t.highestScoreNode=null,t.lifeBar=null,t.bgm=null,t.backgroundInitPos=-72,t.backgroundResetPos=56,t.wallInitPos=-23,t.wallResetPos=9,t.physicManager=null,t.leftDown=!1,t.rightDown=!1,t.score=0,t.highestScore=0,t.pause=!1,t.playerLife=12,t}return __extends(t,e),t.prototype.onLoad=function(){this.physicManager=cc.director.getPhysicsManager(),this.physicManager.enabled=!0,this.physicManager.gravity=cc.v2(0,-200),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},t.prototype.start=function(){var e=this;this.schedule(function(){var t=e.randomChoosePlatform(),o=cc.instantiate(e.platformPrefabs[t]);o.parent=e.platforms,o.position=cc.v2(288*Math.random()-144,-190)},1.2),this.updateHighestScore(0),this.scoreCount=function(){e.updateScore(e.score+1)}},t.prototype.update=function(){this.wall.y>=this.wallResetPos&&(this.wall.y=this.wallInitPos),this.background.y+=.2,this.background.y>=this.backgroundResetPos&&(this.background.y=this.backgroundInitPos)},t.prototype.onKeyDown=function(e){switch(e.keyCode){case cc.macro.KEY.left:this.leftDown=!0,this.player.playerMove(-1);break;case cc.macro.KEY.right:this.rightDown=!0,this.player.playerMove(1);break;case cc.macro.KEY.a:this.gameStart();break;case cc.macro.KEY.d:this.gameOver()}},t.prototype.onKeyUp=function(e){switch(e.keyCode){case cc.macro.KEY.left:this.leftDown=!1,this.rightDown?this.player.playerMove(1):this.player.playerMove(0);break;case cc.macro.KEY.right:this.rightDown=!1,this.leftDown?this.player.playerMove(-1):this.player.playerMove(0)}},t.prototype.randomChoosePlatform=function(){for(var e=Math.random(),t=[6,2,2,3,2],o=t.reduce(function(e,t){return e+t}),i=1;i<t.length;i++)t[i]+=t[i-1];for(i=0;i<t.length;i++)if(t[i]/=o,e<=t[i])return i},t.prototype.updateHighestScore=function(e){this.highestScore=e,this.highestScoreNode.getComponent(cc.Label).string=(Array(4).join("0")+this.highestScore.toString()).slice(-4)},t.prototype.updateScore=function(e){this.score=e,this.scoreNode.getComponent(cc.Label).string=(Array(4).join("0")+this.score.toString()).slice(-4)},t.prototype.updateLife=function(e){this.playerLife+=e,this.playerLife=Math.min(Math.max(this.playerLife,0),12),this.lifeBar.width=8*this.playerLife,0==this.playerLife&&this.gameOver()},t.prototype.gameStart=function(){this.startIcon.active=!1,this.score>this.highestScore&&this.updateHighestScore(this.score),this.updateScore(1),this.updateLife(12);var e=cc.v2();this.platforms.children.forEach(function(t){t.getComponent("Platform").reset(),"Nails"!=t.name&&(e=t.position.add(cc.v2(0,50)))}),this.player.reborn(e),this.player.node.active=!0,this.schedule(this.scoreCount,2),cc.audioEngine.playMusic(this.bgm,!0)},t.prototype.gamePause=function(){this.pause?this.pause=!1:this.pause=!0,this.pause?(this.pauseIcon.active=!0,this.scheduleOnce(function(){cc.game.pause()},.1)):(this.pauseIcon.active=!1,cc.game.resume())},t.prototype.gameOver=function(){this.player.node.active=!1,this.unschedule(this.scoreCount),this.startIcon.active=!0,cc.audioEngine.stopMusic()},t.prototype.gameEnd=function(){cc.game.end()},__decorate([r(cc.Node)],t.prototype,"background",void 0),__decorate([r(cc.Node)],t.prototype,"wall",void 0),__decorate([r(cc.Node)],t.prototype,"upperBound",void 0),__decorate([r(cc.Node)],t.prototype,"lowerBound",void 0),__decorate([r(i.default)],t.prototype,"player",void 0),__decorate([r(cc.Node)],t.prototype,"platforms",void 0),__decorate([r([cc.Prefab])],t.prototype,"platformPrefabs",void 0),__decorate([r(cc.Node)],t.prototype,"startIcon",void 0),__decorate([r(cc.Node)],t.prototype,"pauseIcon",void 0),__decorate([r(cc.Node)],t.prototype,"scoreNode",void 0),__decorate([r(cc.Node)],t.prototype,"highestScoreNode",void 0),__decorate([r(cc.Node)],t.prototype,"lifeBar",void 0),__decorate([r({type:cc.AudioClip})],t.prototype,"bgm",void 0),__decorate([n],t)}(cc.Component);o.default=s,cc._RF.pop()},{"./Player":"Player"}],Platform:[function(e,t,o){"use strict";cc._RF.push(t,"a3e6dBne/JI4rscTjPZ8hyF","Platform"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,n=i.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.soundEffect=null,t.hasDamaged=!1,t.hasHealed=!1,t.trampolineHealed=!1,t.isTouched=!1,t.conveyorSpeed=0,t.anim=null,t.highestPos=118,t.moveSpeed=100,t.springVelocity=320,t}return __extends(t,e),t.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation),this.originalColliderState=this.getComponent(cc.PhysicsBoxCollider).enabled,"Conveyor"===this.node.name&&(this.node.scaleX=Math.random()>=.5?1:-1,this.conveyorSpeed=this.moveSpeed*this.node.scaleX),this.getComponent(cc.PhysicsBoxCollider)},t.prototype.update=function(){this.node.y>this.highestPos+100&&this.platformDestroy()},t.prototype.reset=function(){this.hasDamaged=!1,this.hasHealed=!1,this.trampolineHealed=!1,this.isTouched=!1,"Fake"===this.node.name&&(this.getComponent(cc.PhysicsBoxCollider).enabled=this.originalColliderState)},t.prototype.onBeginContact=function(e,t,o){if(e.getWorldManifold().normal.y<.7)e.disabled=!0;else{var i=o.node.getComponent("Player");if(i){var a=this.node.name;if("Trampoline"===a?cc.audioEngine.playEffect(this.soundEffect,!1):!this.isTouched&&this.soundEffect&&(cc.audioEngine.playEffect(this.soundEffect,!1),this.isTouched=!0),"Nails"!==a){switch(a){case"Trampoline":this.trampolineHealed||(i.playerRecover(),this.trampolineHealed=!0);break;default:this.hasHealed||(i.playerRecover(),this.hasHealed=!0)}switch(a){case"Trampoline":this.handleTrampoline(o);break;case"Fake":this.handleFakePlatform()}}else this.hasDamaged||(i.playerDamage(),this.hasDamaged=!0)}}},t.prototype.onEndContact=function(e,t,o){var i=this.node.name;if("Conveyor"===i){var a=o.node.getComponent(cc.RigidBody);a&&(a.linearVelocity=cc.v2(0,a.linearVelocity.y))}"Trampoline"===i&&(this.trampolineHealed=!1)},t.prototype.handleTrampoline=function(e){var t=e.node.getComponent(cc.RigidBody);t&&(t.linearVelocity=cc.v2(t.linearVelocity.x,this.springVelocity),this.playAnim())},t.prototype.handleFakePlatform=function(){var e=this;this.playAnim(),this.scheduleOnce(function(){e.getComponent(cc.PhysicsBoxCollider).enabled=!1},.2)},t.prototype.onPreSolve=function(e,t,o){if("Conveyor"===this.node.name){var i=o.node.getComponent(cc.RigidBody);i&&(i.linearVelocity=cc.v2(this.conveyorSpeed,i.linearVelocity.y))}},t.prototype.platformDestroy=function(){this.node.destroy()},t.prototype.playAnim=function(){this.anim&&this.anim.play()},__decorate([n({type:cc.AudioClip})],t.prototype,"soundEffect",void 0),__decorate([a],t)}(cc.Component);o.default=r,cc._RF.pop()},{}],Player:[function(e,t,o){"use strict";cc._RF.push(t,"3cd2fFlgBpPIYNN/GI2S42+","Player"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,n=i.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.playerSpeed=300,t.playerStandSpeed=50,t.nailSound=null,t.dieSound=null,t.gameMgr=null,t.idleFrame=null,t.anim=null,t.moveDir=0,t.ceilingPos=155,t.fallDown=!1,t.damageTime=0,t}return __extends(t,e),t.prototype.start=function(){this.idleFrame=this.getComponent(cc.Sprite).spriteFrame,this.anim=this.getComponent(cc.Animation)},t.prototype.update=function(e){this.node.x+=this.playerSpeed*this.moveDir*e,this.node.scaleX=this.moveDir>=0?1:-1,this.node.y=this.node.y>=this.ceilingPos?this.ceilingPos:this.node.y,this.getComponent(cc.RigidBody).linearVelocity.y!=this.playerStandSpeed?this.fallDown=!0:this.fallDown=!1,this.damageTime>0?this.damageTime-=e:this.damageTime=0,this.playerAnimation()},t.prototype.reborn=function(e){this.damageTime=0,this.node.position=e,this.getComponent(cc.RigidBody).linearVelocity=cc.v2()},t.prototype.playerMove=function(e){this.moveDir=e},t.prototype.playerRecover=function(){this.gameMgr.getComponent("GameMgr").updateLife(1)},t.prototype.playerDamage=function(){this.damageTime=1,cc.audioEngine.playEffect(this.nailSound,!1),this.gameMgr.getComponent("GameMgr").updateLife(-5)},t.prototype.playerDie=function(){cc.audioEngine.playEffect(this.dieSound,!1),this.gameMgr.getComponent("GameMgr").updateLife(-12)},t.prototype.playerAnimation=function(){this.fallDown?this.damageTime>0?0!=this.moveDir||this.anim.getAnimationState("fall_front_hurt").isPlaying?0==this.moveDir||this.anim.getAnimationState("fall_side_hurt").isPlaying||this.anim.play("fall_side_hurt"):this.anim.play("fall_front_hurt"):0!=this.moveDir||this.anim.getAnimationState("fall_front").isPlaying?0==this.moveDir||this.anim.getAnimationState("fall_side").isPlaying||this.anim.play("fall_side"):this.anim.play("fall_front"):this.damageTime>0?0!=this.moveDir||this.anim.getAnimationState("idle_hurt").isPlaying?0==this.moveDir||this.anim.getAnimationState("walk_hurt").isPlaying||this.anim.play("walk_hurt"):this.anim.play("idle_hurt"):0==this.moveDir?(this.anim.stop(),this.getComponent(cc.Sprite).spriteFrame=this.idleFrame):this.anim.getAnimationState("walk").isPlaying||this.anim.play("walk")},t.prototype.onBeginContact=function(e,t,o){"lowerBound"==o.node.name?this.playerDie():"ceiling"==o.node.name&&(cc.log("player contact"),this.playerDamage())},__decorate([n()],t.prototype,"playerSpeed",void 0),__decorate([n()],t.prototype,"playerStandSpeed",void 0),__decorate([n({type:cc.AudioClip})],t.prototype,"nailSound",void 0),__decorate([n({type:cc.AudioClip})],t.prototype,"dieSound",void 0),__decorate([n(cc.Node)],t.prototype,"gameMgr",void 0),__decorate([a],t)}(cc.Component);o.default=r,cc._RF.pop()},{}],use_reversed_rotateTo:[function(e,t){"use strict";cc._RF.push(t,"044f5/W0hdGRrziA4oee7Cm","use_reversed_rotateTo"),cc.RotateTo._reverse=!0,cc._RF.pop()},{}]},{},["GameMgr","Platform","Player","use_reversed_rotateTo"]);